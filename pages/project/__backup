import { useRouter } from 'next/router'
import { useState, useEffect } from 'react'
import HeaderData from '../../data/HeaderData'
import ProjectData from '../../data/ProjectsData'
import Loader from '../../components/Loader'
import Header from '../../components/Header'
import Carousel from 'react-multi-carousel';
import 'react-multi-carousel/lib/styles.css';
import { Jumbotron, ListGroup } from 'react-bootstrap'

const singleProject = (deviceType = 'tablet') => {
    const { query: { project: index } } = useRouter()

    const [data, setData] = useState(null)

    const [headerData, setHeaderData] = useState(null)

    const [project, setProject] = useState(null)


    useEffect(() => {
        if (!data) {
            setData(ProjectData(location.search.split('=')[1]))
        }
        if (!project && data) {
            setProject(data.projects[Number(index)])
        }
        if (!headerData) {
            setHeaderData(HeaderData(location.search.split('=')[1]))
        }
    }, [project, data, headerData, index])

    const responsive = {
        desktop: {
            breakpoint: { max: 3000, min: 1024 },
            items: 2,
            slidesToSlide: 1 // optional, default to 1.
        },
        tablet: {
            breakpoint: { max: 1025, min: 464 },
            items: 2,
            slidesToSlide: 1 // optional, default to 1.
        },
        mobile: {
            breakpoint: { max: 464, min: 0 },
            items: 1,
            slidesToSlide: 1 // optional, default to 1.
        }
    }

    if (!data || !project || !headerData) {
        return <Loader />
    }
    else {
        return (
            <>
                <Header data={headerData} />
                <Jumbotron className='main-section bg-secondary'>
                    <ListGroup>
                        <ListGroup.Item>
                            <Carousel
                                swipeable={true}
                                draggable={true}
                                showDots={false}
                                responsive={responsive}
                                ssr={true} // means to render carousel on server-side.
                                infinite={false}
                                autoPlay={deviceType !== "mobile" ? true : false}
                                autoPlaySpeed={4000}
                                keyBoardControl={true}
                                focusOnSelect={true}
                                containerClass="carousel-container"
                                deviceType={deviceType}
                                itemClass="carousel-item-padding-40-px"
                                centerMode={deviceType !== "mobile" ? true : false}
                            >
                                {project.img.map((el) => (
                                    <img style={{ margin: '1em' }} src={el} alt={project.title}></img>
                                ))}
                            </Carousel>
                        </ListGroup.Item >
                        <ListGroup.Item className='bg-dark'>
                            <h4 >{project.title}</h4>
                            <h6> {project.description}</h6>
                        </ListGroup.Item>
                    </ListGroup>
                </Jumbotron>

            </>
        )
    }
}
export default singleProject
